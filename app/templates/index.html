{# app/templates/index.html #}
{% extends "base.html" %} {# 继承基础模板 #}

{# 设置页面浏览器标题 #}
{% block title %}选择课程 - NCE Vocab Quiz{% endblock %}

{# 定义页面主要内容 #}
{% block content %}

{# 将 container 移到 base.html 的 <main> 标签可能更好，但放在这里也可以 #}
{# <div class="container"> #}

    <h2>选择测试范围 (Select Test Scope)</h2>

    {# 课程选择和测试选项表单 #}
    <form id="lesson-selector">
        <fieldset>
            <legend>选择课程 (Select Lessons for Quiz and View Text)</legend>
            <div class="lesson-list-container"> {# 用于包裹课程列表的容器 #}

                {# 检查后端是否传递了 lessons 列表 #}
                {% if lessons %}
                    {# 如果有课程，遍历并显示 #}
                    {% for lesson_num in lessons %}
                        <div class="lesson-item" style="margin-bottom: 8px; padding: 5px; border-bottom: 1px solid #eee;">
                            {# 复选框，用于选择参加词汇测试的课程 #}
                            <input type="checkbox" name="lesson" value="{{ lesson_num }}" id="lesson-check-{{ lesson_num }}" style="margin-right: 10px;">

                            {# 标签与复选框关联，包含课程链接 #}
                            <label for="lesson-check-{{ lesson_num }}">
                                {# 指向该课文页面的链接 #}
                                <a href="{{ url_for('view_lesson', lesson_number=lesson_num) }}" title="查看 Lesson {{ lesson_num }} 课文">
                                    Lesson {{ lesson_num }}
                                </a>
                                {# 提示文字 #}
                                <span style="font-size: 0.9em; color: #555;"> (查看课文 / View Text)</span>
                            </label>
                        </div>
                    {% endfor %} {# 结束 for 循环 #}

                {% else %} {# 如果 lessons 列表为空 #}
                    <p>数据库中没有找到课程。请先处理 PDF 文件。</p>
                    {# 提供一个（管理员）按钮来触发 PDF 处理 #}
                    <form action="{{ url_for('process_pdf_route') }}" method="post" style="margin-top: 15px;">
                         <button type="submit">处理 NCE Book 2 PDF (管理员)</button>
                    </form>

                {% endif %} {# 正确关闭 if lessons 块 #}

            </div> {# End lesson-list-container #}
        </fieldset>

        {# 词汇测试选项 #}
        <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #eee;">
            <h3>词汇测试选项 (Vocabulary Quiz Options)</h3>
            <div>
                <label for="num-questions" style="display: inline-block; margin-right: 10px;">题目数量:</label>
                <input type="number" id="num-questions" value="10" min="1" max="50" style="width: 60px;">
            </div>
            <div style="margin-top: 10px;">
                <label for="quiz-type" style="display: inline-block; margin-right: 10px;">测试类型:</label>
                <select id="quiz-type">
                    <option value="cn_to_en" selected>中译英 (写英文)</option>
                    <option value="en_to_cn">英译中 (写中文)</option>
                </select>
            </div>
            <div style="margin-top: 20px;">
                 {# 启动词汇测试的按钮 #}
                <button type="button" id="start-quiz-btn">开始单词测试 (Start Vocabulary Quiz)</button>
            </div>
        </div>
    </form> {# 结束表单 #}

    {# 分隔线 #}
    <hr style="margin-top: 30px; margin-bottom: 30px;">

    {# 用于通过 JavaScript 加载测试题的区域 (默认隐藏) #}
    <div id="quiz-area" class="hidden">
        <h2>测试进行中...</h2>
        <div id="questions-container">
            </div>
        <button type="button" id="submit-quiz-btn" class="hidden" style="margin-top: 20px;">提交答案</button>
    </div>

    {# 用于通过 JavaScript 显示测试结果的区域 (默认隐藏) #}
    <div id="results-area" class="hidden">
        <h2>测试结果</h2>
        <p>你的得分: <span id="score"></span> / <span id="total-questions"></span></p>
        <h3>错题回顾:</h3>
        <ul id="incorrect-list" style="padding-left: 20px;">
            </ul>
        <button type="button" id="restart-quiz-btn" style="margin-top: 15px;">重新开始 (Restart)</button>
    </div>

    {# 加载指示器 (默认隐藏) #}
    <div id="loading-indicator" class="hidden">
        <p>请稍候...</p>
    </div>

    {# 错误消息显示区域 (默认隐藏) #}
     <div id="error-message" class="hidden error"></div>

{# </div> End container #} {# 如果 container 在 base.html 中，这里就不需要结束标签 #}

{% endblock %} {# 结束 content 块 #}