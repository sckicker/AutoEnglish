{# app/templates/index.html #}
{% extends "base.html" %}

{% block title %}选择课程 - NCE Vocab Quiz{% endblock %}

{% block content %}

    <h2>新概念英语词汇学习平台</h2>
    <p class="lead" style="margin-bottom: 20px; color: #555;">欢迎使用新概念英语词汇学习平台，选择课程开始你的词汇测试吧！</p>

    <div class="quiz-options-container">
        <h3>词汇测试选项</h3>
        <div style="margin-bottom: 10px;">
            <label for="num-questions">题目数量:</label>
            <input type="number" id="num-questions" value="10" min="1" max="50">
        </div>
        <div style="margin-bottom: 10px;">
            <label for="quiz-type">测试类型:</label>
            <select id="quiz-type">
                <option value="cn_to_en" selected>中译英 (写英文)</option>
                <option value="en_to_cn">英译中 (写中文)</option>
            </select>
        </div>
        <div>
             <button type="button" id="start-quiz-btn">开始单词测试</button>
        </div>
    </div>

    <hr style="margin-top: 30px; margin-bottom: 30px;">

    <h3>选择测试范围</h3>
    <form id="lesson-selector">
        <fieldset>
            <legend>选择课程</legend>
            <div class="lesson-list-container">
                {% if lessons %}
                    {% for lesson_num in lessons %}
                        <div class="lesson-item">
                            <input type="checkbox" name="lesson" value="{{ lesson_num }}" id="lesson-check-{{ lesson_num }}" style="margin-right: 10px;">
                            <label for="lesson-check-{{ lesson_num }}">
                                <a href="{{ url_for('view_lesson', lesson_number=lesson_num) }}" title="查看 Lesson {{ lesson_num }} 课文">
                                    Lesson {{ lesson_num }}
                                </a>
                                <span style="font-size: 0.9em; color: #777;"> (View Text)</span>
                            </label>
                        </div>
                    {% endfor %}
                {% else %}
                    <p>数据库中没有找到课程。请先处理 PDF 文件。</p>
                    <form action="{{ url_for('process_pdf_route') }}" method="post" style="margin-top: 15px;">
                         <button type="submit">处理 NCE Book 2 PDF (管理员)</button>
                    </form>
                {% endif %}
            </div>
        </fieldset>
    </form>

    {# 分隔线 #}
    <hr style="margin-top: 30px; margin-bottom: 30px; clear: both;">

    <h3>管理员登录</h3>
    <form action="{{ url_for('admin_login') }}" method="POST">
        <div>
            <label for="username">用户名:</label>
            <input type="text" id="username" name="username" required>
        </div>
        <div style="margin-top: 10px;">
            <label for="password">密码:</label>
            <input type="password" id="password" name="password" required>
        </div>
        <div style="margin-top: 15px;">
            <button type="submit">登录</button>
        </div>
    </form>

    {# 用于通过 JavaScript 加载测试题的区域 (默认隐藏) #}
    <div id="quiz-area" class="hidden">
        <h2>测试进行中...</h2>
        <div id="questions-container">
            </div>
        <button type="button" id="submit-quiz-btn" class="hidden" style="margin-top: 20px;">提交答案</button>
    </div>

    {# 用于通过 JavaScript 显示测试结果的区域 (默认隐藏) #}
    <div id="results-area" class="hidden">
        <h2>测试结果</h2>
        <p>你的得分: <span id="score"></span> / <span id="total-questions"></span></p>
        <h3>错题回顾:</h3>
        <ul id="incorrect-list" style="padding-left: 20px;">
            </ul>
        <button type="button" id="restart-quiz-btn" style="margin-top: 15px;">重新开始</button>
    </div>

    {# 加载指示器 (默认隐藏) #}
    <div id="loading-indicator" class="hidden">
        <p>请稍候...</p>
    </div>

    {# 错误消息显示区域 (默认隐藏) #}
     <div id="error-message" class="hidden error"></div>

{% endblock %}